<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ltd.moore.ctravel.experience.mapper.ExperienceAllMapper">

    <sql id="Column_List">
        C .SERVICE_NAME
        ,C .SERVICE_TYPE_ID
        ,D.EXPERIENCE_DETAIL_ID
        ,D.EXPERIENCE_ID
        ,D.TITLE
        ,D.SUBTITLE
        ,D.IMAGE_URL
        ,D.CONTENT_DESCRIPTION
        ,D.DESTINATION
        ,D.RENDEZVOUS
        ,D.CONTENT_DETAILS
        ,D.COMMENT
        ,D.REQUIREMENT
        ,D.PEOPLE_NUMBER
        ,D.SORT_NO
    </sql>
    <sql id="Column_List2">
        B.CUSTOMER_ID
        ,B.CURRENCY_TYPE
        ,B.PRICE
        ,B.ENABLED
        ,B.CREATE_TIME
    </sql>
    <sql id="Where_Clause">
        <where>
            <if test="condition.experienceDetailId != null" >AND EXPERIENCE_DETAIL_ID = #{experienceDetailId}</if>
            <if test="condition.experienceId != null" >AND EXPERIENCE_ID = #{experienceId}</if>
            <if test="condition.destinationId != null" >AND DESTINATION_ID = #{destinationId}</if>
            <if test="condition.title != null" >AND TITLE = #{title}</if>
            <if test="condition.subtitle != null" >AND SUBTITLE = #{subtitle}</if>
            <if test="condition.imageUrl != null" >AND IMAGE_URL = #{imageUrl}</if>
            <if test="condition.contentDescription != null" >AND CONTENT_DESCRIPTION = #{contentDescription}</if>
            <if test="condition.destination != null" >AND DESTINATION = #{destination}</if>
            <if test="condition.rendezvous != null" >AND RENDEZVOUS = #{rendezvous}</if>
            <if test="condition.contentDetails != null" >AND CONTENT_DETAILS = #{contentDetails}</if>
            <if test="condition.comment != null" >AND COMMENT = #{comment}</if>
            <if test="condition.requirement != null" >AND REQUIREMENT = #{requirement}</if>
            <if test="condition.peopleNumber != null" >AND PEOPLE_NUMBER = #{peopleNumber}</if>
            <if test="condition.sortNo != null" >AND SORT_NO = #{sortNo}</if>
        </where>
    </sql>

    <sql id="Where_Clause2">
        <where>
            1=1
            <if test="condition.title != null and condition.title!='' ">
                AND TITLE like CONCAT('%','${condition.title}','%' )
            </if>
            <if test="condition.serviceName != null and condition.serviceName!='' ">
                AND C.SERVICE_NAME=#{condition.serviceName}
            </if>
            <if test="condition.enabled != null and condition.enabled!='' ">
                AND B.ENABLED =#{condition.enabled}
            </if>
            <if test="condition.experienceId != null and condition.experienceId!='' ">
                AND D.EXPERIENCE_ID =#{condition.experienceId}
            </if>
        </where>
    </sql>
    <select id="getById" resultType="ltd.moore.ctravel.experience.model.ExperienceDetailVO" parameterType="String">
        select <include refid="Column_List" />
        from PUB_EXPERIENCE_DETAIL where EXPERIENCE_DETAIL_ID = #{experienceDetailId}
    </select>

    <select id="count" resultType="int" parameterType="map">
        select COUNT(1)
        from PUB_EXPERIENCE_AND_SERVICE_TYPE A , PUB_EXPERIENCE B, PUB_SERVICE_TYPE C,PUB_EXPERIENCE_DETAIL D
        <include refid="Where_Clause2" />
        AND A.EXPERIENCE_ID = B.EXPERIENCE_ID AND A.EXPERIENCE_ID = D.EXPERIENCE_ID AND C.SERVICE_TYPE_ID = A.SERVICE_TYPE_ID
    </select>

    <select id="list" resultType="ltd.moore.ctravel.experience.model.ExperienceAllVO" parameterType="map">
        select <include refid="Column_List" />,<include refid="Column_List2" />
        from PUB_EXPERIENCE_AND_SERVICE_TYPE A , PUB_EXPERIENCE B, PUB_SERVICE_TYPE C,PUB_EXPERIENCE_DETAIL D
        <include refid="Where_Clause2" />
        AND A.EXPERIENCE_ID = B.EXPERIENCE_ID AND A.EXPERIENCE_ID = D.EXPERIENCE_ID AND C.SERVICE_TYPE_ID = A.SERVICE_TYPE_ID
    </select>

    <insert id="insert" parameterType="ltd.moore.ctravel.experience.model.ExperienceDetailVO">
        insert into PUB_EXPERIENCE_DETAIL (<include refid="Column_List" />)
        values (
        #{experienceDetailId}
        ,#{experienceId}
        ,#{destinationId}
        ,#{title}
        ,#{subtitle}
        ,#{imageUrl}
        ,#{contentDescription}
        ,#{destination}
        ,#{rendezvous}
        ,#{contentDetails}
        ,#{comment}
        ,#{requirement}
        ,#{peopleNumber}
        ,#{sortNo}
        )
    </insert>

    <update id="update" parameterType="ltd.moore.ctravel.experience.model.ExperienceDetailVO">
        update PUB_EXPERIENCE_DETAIL
        <set>
            <if test="experienceDetailId != null" >EXPERIENCE_DETAIL_ID = #{experienceDetailId},</if>
            <if test="experienceId != null" >EXPERIENCE_ID = #{experienceId},</if>
            <if test="destinationId != null" >DESTINATION_ID = #{destinationId},</if>
            <if test="title != null" >TITLE = #{title},</if>
            <if test="subtitle != null" >SUBTITLE = #{subtitle},</if>
            <if test="imageUrl != null" >IMAGE_URL = #{imageUrl},</if>
            <if test="contentDescription != null" >CONTENT_DESCRIPTION = #{contentDescription},</if>
            <if test="destination != null" >DESTINATION = #{destination},</if>
            <if test="rendezvous != null" >RENDEZVOUS = #{rendezvous},</if>
            <if test="contentDetails != null" >CONTENT_DETAILS = #{contentDetails},</if>
            <if test="comment != null" >COMMENT = #{comment},</if>
            <if test="requirement != null" >REQUIREMENT = #{requirement},</if>
            <if test="peopleNumber != null" >PEOPLE_NUMBER = #{peopleNumber},</if>
            <if test="sortNo != null" >	SORT_NO = #{sortNo},</if>
        </set>
        where EXPERIENCE_DETAIL_ID = #{experienceDetailId}
    </update>

    <delete id="delete" parameterType="java.lang.String" >
        delete from PUB_EXPERIENCE_DETAIL  where EXPERIENCE_DETAIL_ID = #{experienceDetailId}
    </delete>

    <delete id="deleteInBulk" parameterType="java.lang.String">
        delete from PUB_EXPERIENCE_DETAIL  where EXPERIENCE_DETAIL_ID in
        <foreach item="item" index="index" collection="array" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>
</mapper>